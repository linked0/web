<html>
<body>
<h2>Memo</h2>

<pre>
<a href="https://linked0.github.io/web/solidity.html">solidity.html, https://bit.ly/47DUb2v </a><br>
<a href="https://linked0.github.io/web/know-bak.html">know-bak.html, https://bit.ly/3Oqhxjf </a><br>
<a href="http://bit.ly/2EluV7n">sites.txt</a><br>
<a href="http://goo.gl/B2Drsz">gdrive 기술문서</a><br>
<a href="http://bit.ly/2HKEsmS">colab aplay</a><br>
<a href="https://github.com/linked0/web/blob/master/know.html">web/know github </a><br>
<a href="http://remix.ethereum.org/">Remix online</a>

##################################################################################
L, Ryusaki
##################################################################################
1. command

1)  여러 sub directory에 node_modules를 제거함.
tar --exclude='*/node_modules' --exclude='.git' -cvzf ~/temp/pooh-tools.tar.gz .

2) VSCode Command Palette 를 열어줍니다. [⇧⌘P ]
Shell command
back: ctrl - , forward: shift ctrl -

- ctrl tab: recent files
- shift cmd n - cmd shift /: open project 
- ctrl `: goto terminal 

3) screen -X -S session_id quit
- ctrl a+d	// exit
- screen -S el -X quit
- screen -r -d 17288 <-- attatch되어 있는 것 detach

4) opt cmd b - Bookmark

5) 최신버전으로 리셋하기
실수로 origin의 main에 push해도 upstream에 merge가능

6) ssh-keygen -t rsa

7) solidiy
import "hardhat/console.sol";
npx hardhat compile

8) const tx = await factoryInstance.setFeeTo(process.env.FEE_TO); 
const receipt = await (await tx).wait();

9) brew install golang
PATH=$PATH:$HOME/go/bin
go install github.com/protolambda/zcli@latest
zcli --help
alias nd1="ssh -i ~/pooh/tednet.pem ubuntu@13.209.149.243"

10). docker
- docker attach <image_name>

11) docker ps | grep 5432

- 파일의 권한도 github으로 등록된다. run_node 실행권한

- To restore the entire staging area to the HEAD commit, you can run the following command:
git restore --staged .

- 수호는 블록체인 생태계를 활성화하고 연결하기 위하여 Bridge, DEX와 같은 Dapp 프로덕트를 개발하고 있습니다.

—————————————————————————————
2. NodeJs 프로젝트
- npm init -y
- touch index.js

—————————————————————————————	
3. TypeScript 프로젝트 
- npm install -g typescript
- npm init -y
- npx tsc --init
- package.json --> CoPilot이 다 해줌
  "build": "tsc",
  "start": "node dist/index.js"
- tsconfig.json
  "outDir": "./dist",  
  "include": ["./scripts", "./test", "./typechain"],
  "files": ["./hardhat.config.ts"]
- mkdir src
- touch src/index.ts
- yarn build
- yarn start

—————————————————————————————
4. Hardhat은 기존 프로젝트에서는 안됨.
yarn init -y (=npm init -y)
yarn add --dev hardhat
npx hardhat
yarn add @openzeppelin/contracts


아래 두개는 같이 쓰면 안됨.
import "@nomicfoundation/hardhat-toolbox";
import "@nomiclabs/hardhat-waffle"; // 이것만써.

yarn add dotenv

alchemy keyless 설명에 alchemy web3 설치방법.
그리고, 요새는 type-chains폴더 안쓰는 것 같음.
—————————————————————————————
5.  python 프로그램
python -m venv venv
source venv/bin/activate

if __name__ == "__main__":
    hello_world()

pip install requests
pip freeze > requirements.txt
pip install -r requirements.txt

==> setup.py를 이용하는 것도 필요.
from setuptools import find_packages, setup
setup(
    name="staking_deposit",
    version='2.5.2',
    py_modules=["staking_deposit"],
    packages=find_packages(exclude=('tests', 'docs')),
    python_requires=">=3.8,<4",
)
python ./staking_deposit/deposit.py "$@"를 사용가능.

—————————————————————————————
6. Colab 이용하기

—————————————————————————————
7. Remix이용하기/로컬네트워크 이용하기
yarn hardhat node 

—————————————————————————————
8. PostMan, CURL이용하기

—————————————————————————————
9.  EL
- ./init pow 1 & ./enode pow el1
- ./init pow 2 & ./enode pow el2

—————————————————————————————
10.  CL
1. 블럭해시과 genesis time(date +%s)을 chain-config 반영하고 eth2-testnet-genesis 실행
- gen_genesis
- zcli pretty bellatrix  BeaconState genesis.ssz > parsedState.json로 Validators Root 가져오기
- settings.py에 GENESIS_VALIDATORS_ROOT에 추가, 근데 이건 거의 안 바뀜.
2. staking-deposit-cli로 wallet 만들기
- sudo ./deposit.sh install, 만약 longinterpr.h 에러 발생하면 아래 실행
  - python3.10 -m venv py310
  - source py310/bin/activate
- ./deposit.sh existing-mnemonic
3. 첫번째 cnode 실행하고 enr 알아내서 bootstrap-node 
- cl은 el과 연동되므로 init할 필요 없음
- poohprysm 루트폴더의 cnode로 실행.
4. 나머지 cl 실행시키기
5. keys & validators
- poohprysm 루트폴더에서 찾아야 함.

##################################################################################
New<a href="http://bit.ly/2ZY033D">.</a> Comer/기타/Shortcut
##################################################################################
- bit.ly/44TH7Ua : Memo Pub
- bit.ly/357Is0p : Memo

# command
- cmd space: Launchpad
- brew install truffle (npm install -g truffle 대신), ganache도 마찬가지
- npx hardhat compile --force: typechain 폴더가 없을때
- npm run test
- elephantsql.com
	○   nodemon index.js
- npm install @types/pg
- 맥에서 숨김 파일: cmd + shift + .

# Contract Size
https://ethereum.stackexchange.com/questions/31515/how-to-check-the-size-of-a-contract-in-solidity


These scripts are used to create a Conduit whose address should be assigned to SharedStorefrontLazyMintAdapter contract.
We can create a Conduit with the create_conduit.ts script and get the address of the Conduit with the get_conduit script. There's some error in creating a Conduit with ConduitCreator so we will use the ConduitController contract for a while.

—————————————————————————————
# Slack
• github subscribe
	○ /github subscribe  bosagora/boa-space-contracts issues pulls commits releases deployments reviews comments

Shortcuts
• Option F12
• Navigate: Option Cmd Left/Right 
• To copy the formatting of selected text:
	○ Press Ctrl + Alt + c (Windows or Chrome OS) or ⌘ + Option + c (Mac).
	○ Press Ctrl + Alt + v (Windows or Chrome OS) or ⌘ + Option + v (Mac).

—————————————————————————————
@ 문제 상황 처리
# 예상치 못한 컴파일 에러가 나올때
- brew update && brew upgrade

* 기본준비
    * Calendar 추가(Dev Team)
    * 스타일가이드: https://github.com/bpfkorea/agora/blob/v0.x.x/doc/Style.md, 상세한 설명 필요

* APIs
    * 유통량: https://api.bosplatformfoundation.io/boa_circulating_supply
    * 총발행량: https://api.bosplatformfoundation.io/boa_supply


### Mac Spotlight에서 특정 애플리케이션 찾지 못할 때
First, turn off Spotlight:
sudo mdutil -a -i off

Next, unload the metadata file that controls Spotlight's index:
sudo launchctl unload -w /System/Library/LaunchDaemons/com.apple.metadata.mds.plist
여기서 에러날 수 있음 그냥 무시하고 다음으로 넘어감.

The following command re-loads the index:
sudo launchctl load -w /System/Library/LaunchDaemons/com.apple.metadata.mds.plist

Finally, turn Spotlight back on:
sudo mdutil -a -i on

### Mac에서 Sublime Text를 커맨트창에서 실행시키기
ln -s "/Applications/Sublime Text.app/Contents/SharedSupport/bin/subl" /usr/local/bin/subl
	
##################################################################################
<a href="http://bit.ly/2ZY033D">.</a>Node JS/TypeScript/Hardhat/Screen
##################################################################################


### localhost 실행하기
npx hardhat node

### localhost 배포하기g
npx hardhat run scripts/deploy.ts --network localhost

# Hardhat & Typescript
• Hardhat 프로젝트 만들기
	○ npm init
	○ npm install --save-dev hardhat
	○ npx hardhat
• Prettier 적용
	○ package.json의 "scripts" 섹션에 다음을 추가
		§ "prettier": "node_modules/.bin/prettier --write --config .prettierrc 'contracts/**/*.sol' 'test/**/*.ts' 'utils/**/*.ts' 'scripts/**/*.ts'",

# nvm install
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.34.0/install.sh | bash
. ~/.nvm/nvm.sh <-- nvm 활성화

##################################################################################
<a href="http://bit.ly/2ZY033D">.</a> Git & gitconfig
##################################################################################
- git reset --hard michael/add-npm-script-prettier
	git remote update 한번 해줘야 함.
	해당 브랜치로 들어가서 최신 버전으로 갱신하기 
- git pull <remote> <remote branch>
	로컬의 수정을 반영하기
	ex) git pull zero commons-budget-contract
- git rebase 도중 파일 제거하기
	git rm --cached <file>  
- git rebase 도중 stage된 파일 리셋하기
	git reset HEAD~1 -- package.json
- revert
	# This will create three separate revert commits:
		§ git revert a867b4af 25eee4ca 0766c053
	# It also takes ranges. This will revert the last two commits:
		§ git revert HEAD~2..HEAD
	# Similarly, you can revert a range of commits using commit hashes (non inclusive of first hash):
		§ git revert 0d1d7fc..a867b4a
- 슬랙 연동: /github subscribe zeroone-boa/validators reviews comments
	이것도 방법, 위의 것과 비교 필요: /github subscribe bosagora/boa-space-seaport-js issues pulls commits releases deployments reviews comments
- git clone시 폴더명 지정
	git clone git@github.com:whatever folder-name
- Fatal: Not possible to fast-forward, aborting
	git pull --rebase.
- Merge pull request 발생하지 않도록 Full Requests 설정
	Repository Setting -> Pull Requests
		§ Uncheck: "Allow merge commits", "Allow squash merging" 
- 내가 올린 브랜치에 대해서 자동으로 PR추천을 할수 있도록 하기.
	- Organization의 해당 리파지토리로 이동
	- Settings -> General 이동
	- Always suggest updating pull request branches 를 
- git diff --name-only HEAD~1 HEAD~2

- 단번에 add & commit & push
git config alias.acp '! git commit -a -m "commit" && git push'
그리고 나서 git acp 하면됨

- git log with graph
git log --graph --format=format:'%C(bold blue)%h%C(reset) - %C(bold green)(%ar)%C(reset) %C(white)%an%C(reset)%C(bold yellow)%d%C(reset) %C(dim white)- %s%C(reset)' --all

## private repo clone
- $ key-gen
- $ eval "$(ssh-agent -s)"
- $ ss-add .ssh/id_rsa_graph_node
- id_rsa_graph_node.pub를 cat해서 리파지토리 Setting -> Deploy keys에 추가
- git clone git@github.com:bosagora/boa-space-graph-node.git

## gitconfig
[user]
	email = linked0@gmail.com
	name = Hyunjae Lee
[core]
	excludesfile = /Users/jaylee/.gitignore_global
[difftool "sourcetree"]
	cmd = opendiff \"$LOCAL\" \"$REMOTE\"
	path = 
[mergetool "sourcetree"]
	cmd = /Applications/Sourcetree.app/Contents/Resources/opendiff-w.sh \"$LOCAL\" \"$REMOTE\" -ancestor \"$BASE\" -merge \"$MERGED\"
	trustExitCode = true
[commit]
	template = /Users/jaylee/.stCommitMsg
[alias]
	co = checkout
	lg = log --color --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%\
Creset' --abbrev-commit
	pff = "!f() { REMOTE=$(git remote|grep -E '^upstream$'); git pull --ff-only ${REMOTE:-origin} $(git rev-parse --s\
ymbolic-full-name HEAD); }; f"
	rb  = "!f() { git rebase -i HEAD~$1; }; f"
	ru  = "remote update -p"
	br = branch
	ci = commit
	unstage = reset HEAD --
	st = status
	recentb = for-each-ref --sort=-committerdate refs/heads/ --format='%(HEAD) %(align:20)(%(color:green)%(committerdate:relative)%(color:reset))%(end) %(align:30)%(color:yellow)%(refname:short)%(color:reset)%(end) - %(color:red)%(object\
name:short)%(color:reset) - %(contents:subject)'
[push]
	default = current
[pager]
    diff = delta
    log = delta
    reflog = delta
    show = delta
[delta]
    plus-style = "syntax #012800"
    minus-style = "syntax #340001"
    syntax-theme = Solarized (light)
    navigate = true
    line-numbers = true
[interactive]
    diffFilter = delta --color-only
    
## Organization만들고, 포크하기 (fork)
- poohgithub organization에서 Setting->Members privileges->Allow forking of private repositories.


##################################################################################
cloud/docker
##################################################################################

# AWS에 Load Balancer 추가시 
• Certifacate Manager를 통해서 도메인 추가
	- "Create records in Route 53" 해줘야 함.

# node3에 들어가서 postgresql 도커 접속방법
sudo docker exec -it ec22f5036e09 bash
psql -d db -U postgres -W

# 오류
*  WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!
    * 아래와 같이 수정
    *  Add correct host key in /Users/hyunjaelee/.ssh/known_hosts to get rid of this message.

# public key 확인 및 깃헙에 추가하기
- cat .ssh/id_rsa_linked0.pub
- 계정의 세팅으로 들어가면 “SSH and GPG keys”에 집어넣으면 됨.
- git clone할 때 sudo를 넣어야 “Load key … : Permission denied” 에러가 발생하지 않음.
- “git clone https://github.com/linked0/agora.git” 이건 잘되는 ssh로 받을때 안됨

# 접속
ssh -i "pooh-seoul.pem" ubuntu@ec2-52-79-227-164.ap-northeast-2.compute.amazonaws.com

# AWS에서 파일 전송 
* 가져오기
    * scp -i ~/pooh/pooh-seoul.pem ubuntu@ec2-52-78-204-156.ap-northeast-2.compute.amazonaws.com:~/share/test.txt .
* 보내기
    * scp -i ~/pooh/pooh-seoul.pem test.txt ubuntu@ec2-52-78-204-156.ap-northeast-2.compute.amazonaws.com:~/share/test.txt
———————————————————————————————————
@ AWS ELB 세팅
# Load Balancer 
	- Mappings는 모든 존으로
	- Security Group은 AgoraDevNet_ELB
	- 리스너 지정: Target Group지정
	- 나중에 80에 대해서 443으로 Redirect

# URL로 접근이 안되는 문제
- 실패상황황인데, CNAME과 A 설정만 맞으면 될 것 같음 (230303)

# Target Group
	- Basic configuration: Instances
	- Protocol/Port 지정
	- Protocol version: HTTP1
	- Health checks는 그대로 두면 됨.


###### AWS 타임존 변경
1) $ tzselect
2) .profile에 다음을 추가하고 재로그인
TZ='Asia/Seoul'; export TZ

##################################################################################
vi
##################################################################################
find ./ -type f > files
find . -type file -name '*.js' -o -name '*.json' > files  //-o는 or를 뜻함
find . -type f -not -path './node_modules/*' -not -path './chaindata/*' > files

g t: Next tab, 그냥 에디터에서 g와 t를 치면 됨
g T: Prior tab
nnn g t: Numbered tab, nnn은 숫자를 나타냄, 1일수도 있고, 12일수도 있음.

"*yy           ; copt from vi 
:! wc          ; sh command in vi

:shell 혹은 :sh를 이용해서 shell(:12)로 빠져나갈 수 있다. exit 혹은 Ctrl+D를 이용해서 vim으로 되돌아올 수 있다.
:! # 마지막 커맨드의 결과보기 

mvim --remote-tab-silent search.go  // 같은 윈도우에서 열기

# Move cursor to end of file in vim
:$

* 한글 깨지는 문제
set enc=utf-8

###### vimrc (~/.vimrc)
set nocompatible
filetype off
set rtp+=~/.vim/bundle/Vundle.vim
call vundle#begin()
Plugin 'gmarik/Vundle.vim' "required
Plugin 'tpope/vim-fugitive' "required 
call vundle#end()
filetype plugin indent on " Put your non-Plugin stuff after this line
:w
:source %
:PluginInstall
syntax enable " syntax highlighting
set nu " add line numbers
set smartindent " make smart indent
set tabstop=4 " tab width as 4 (default 8)
set shiftwidth=4
set softtabstop=4       ; TAB키를 눌렀을때 몇 칸을 이동?
set tabstop=4           ; 하나의 TAB을 몇 칸으로 인식? 
set number		            ;  Line Number
set expandtab " spaces for tab
set incsearch
set mouse=a

##################################################################################
command
##################################################################################

##### zsh
xcode-select —-install
/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
brew cask install iterm2
brew install zsh
sh -c "$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)"
sh -c "$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)"

##### NewComer
- Get Lens 써보기
- Maximize Active Pane: shift + cmd + enter
- Command 창: cmd + j
- 탭 좌우 이동: cmd + shift + [ or ]
- “//“로 시작되는 라인 찾을때: “^\/\/“
- Focus editor 1 : cmd + 1
- ctrl - / ctrl shift -: go back/forward
- ./build/agora -c devel/config-single.yaml
- 경로복사: option + cmd + c
- Focus terminal: ctrl + `

##### Generate Private Key
openssl ecparam -name secp256k1 -genkey -noout

##### Mac XCode
brew install macvim --override-system-vim

https://developer.apple.com/download/more/?=command%20line%20tools 에서 다운로드 필요
xcode-select install
sudo xcode-select --switch /Library/Developer/CommandLineTools


# source를 다른 위치에 new_source라는 이름으로 복사(두가지 방법)
cp -a source ~/temp/new_source

find . -iname mainview*
touch -t "201610041200" timestamp
find . -type f -newer timestamp

# 텍스트 찾기
egrep -irnH --include=\*.cpp --exclude-dir=.svn 'beacon.pntbiz.com' ./

sudo xcode-select -s /Applications/XCode7.2/Xcode.app/
To clear the terminal manually: Cmd + K
ps aux | grep chrome

# .bash_profile
export PS1="\W \u$ "

hgrep() {
	grep -irnH --include=*.$1 "$2" ./  
}

alias hello='echo Hi!Jay~'
echo 'export PATH=/usr/local/bin:$PATH' >> ~/.bash_profile



###### Tar
Zip Foler
tar --exclude='node_modules' -cvzf bccard.tar.gz bccard    //하위 폴더들에서 node_modules를 모두 제외시키기
tar --exclude='./BLE/.git' -cvzf output_filename.tar.gz folder_name --exclude='./BLE/.git'
tar -xvzf xxx.tar.gz -C ./data     //data 폴더에 풀고 싶을때.



<a href="https://linked0.github.io/web/solidity.html">solidity.html, https://bit.ly/47DUb2v </a><br>
<a href="https://linked0.github.io/web/know-bak.html">know-bak.html, https://bit.ly/3Oqhxjf</a><br>
<a href="http://bit.ly/2ZY033D"> Know2 </a>
	
</pre></body></html>
